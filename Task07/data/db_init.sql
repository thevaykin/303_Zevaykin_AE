--.open vehicle_inspection.db
--CREATE DATABASE barbershop;

DROP TABLE IF EXISTS employee;
DROP TABLE IF EXISTS service;
DROP TABLE IF EXISTS employee_specialization;
DROP TABLE IF EXISTS work_schedule;
DROP TABLE IF EXISTS work_track;

PRAGMA foreign_keys=ON;

CREATE TABLE employee (
  id INTEGER PRIMARY KEY,
  last_name VARCHAR(100),
  name VARCHAR(100),
  second_name VARCHAR(100) NULL,
  birth_date DATE NULL,
  phone_number VARCHAR(25) NULL,
  cost_percent FLOAT,
  gender VARCHAR(1) NULL,
  dissmiss_date date NULL,

  CHECK (gender = 'М' OR gender = 'Ж'),
  CHECK (cost_percent >= 0.0 AND cost_percent <= 100.0)
);
	
CREATE TABLE service (
  id INTEGER PRIMARY KEY,
  name VARCHAR,
  price FLOAT,
  duration_hour FLOAT
);

CREATE TABLE employee_specialization (
  id INTEGER PRIMARY KEY,
  id_employee INTEGER,
  id_service INTEGER,
  
  FOREIGN KEY (id_employee) REFERENCES employee (id),
  FOREIGN KEY(id_service)  REFERENCES service(id)
);

CREATE TABLE work_schedule (
  id INTEGER PRIMARY KEY,
  id_employee INTEGER,
  work_date DATE,
  start_time TIME NULL DEFAULT '08:00',
  end_time TIME NULL DEFAULT '18:00',
  
  FOREIGN KEY (id_employee) REFERENCES employee (id)
);

CREATE TABLE work_track (
  id INTEGER PRIMARY KEY,
  id_employee INTEGER,
  id_service INTEGER,
  work_date DATE,
  start_work_time TIME NULL,
  end_work_time TIME NULL,
  work_state VARCHAR(30) NULL DEFAULT 'Запланировано',
  client_last_name VARCHAR(100) NULL,
  client_name VARCHAR(100) NULL,
  client_second_name VARCHAR(100) NULL,
  client_phone_number VARCHAR(25) NULL,
  
  FOREIGN KEY (id_employee) REFERENCES employee (id),
  FOREIGN KEY(id_service)  REFERENCES service(id),
  
  CHECK (work_state = 'В работе' OR work_state = 'Запланировано' OR work_state = 'Завершено' OR work_state = 'Отмена')
);

INSERT INTO employee (id, last_name, name, second_name, birth_date, phone_number, cost_percent, gender) values
(0, 'Архипов', 'Кирилл', 'Андреевич', '1999-06-10', '89567839028', 70, 'М'),
(1, 'Горина', 'Мария', 'Вячеславовна', '1998-03-12', '89567658903', 60, 'Ж'),
(2, 'Гришанова', 'Екатерина', 'Сергеевна', '1996-11-03', '89175633425', 70, 'Ж'),
(3, 'Заев', 'Александр', 'Сергеевич', '2000-01-11', '89176653425', 50, 'М'),
(4, 'Захаров', 'Иван', 'Андреевич', '1998-06-25', '89196654333', 73, 'М'),
(5, 'Камаева', 'Анастасия', 'Андреевна', '1998-12-01', '89625931595', 75, 'Ж'),
(6, 'Кренделев', 'Евгений', 'Владимирович', '2000-04-01', '89177645682', 60, 'М'),
(7, 'Лешина', 'Алина', 'Сергеевна', '1999-03-21', '89165554325', 65, 'Ж'),
(8, 'Славкина', 'Анастасия', 'Вячеславовна', '1999-02-01', '89545436729', 50, 'Ж'),
(9, 'Семин', 'Владислав', 'Олегович', '1999-01-03', '89170573644', 65, 'М'),
(10, 'Слесарев', 'Андрей', 'Сергеевич', '1999-04-25', '89625941333', 70, 'М');

INSERT INTO service (id, name, price, duration_hour) VALUES
(0, 'Стрижка женская с сушкой феном', 800, 1.5),
(1, 'Стрижка мужская с сушкой феном', 700, 1),
(2, 'Окрашивание краской Loreal с сушкой', 2000, 2),
(3, 'Окрашивание краска клиента', 1000, 2),
(4, 'Стрижка горячими ножницами', 1500, 1),
(5, 'Стрижка наголо (1 насадка)', 250, 0.5),
(6, 'Стрижка бороды и усов', 400, 1),
(7, 'Мелирование', 700, 1),
(8, 'Химическая завивка', 800, 1),
(9, 'Кератиновое выпрямление', 1500, 1.5),
(10, 'Восстановление волос (1 процедура)', 1000, 1.5);

INSERT INTO employee_specialization (id, id_employee, id_service) VALUES
(0, 0, 5),
(1, 0, 6),
(2, 1, 1),
(3, 1, 5),
(4, 1, 6),
(5, 2, 0),
(6, 2, 3),
(7, 3, 1),
(8, 3, 6),
(9, 4, 1),
(10, 4, 5),
(11, 4, 6),
(12, 5, 2),
(13, 5, 3),
(14, 5, 7),
(15, 6, 4),
(16, 6, 1),
(17, 7, 8),
(18, 7, 9),
(19, 8, 10),
(20, 8, 3),
(21, 9, 4),
(22, 10, 1),
(23, 10, 6);

INSERT INTO work_schedule (id, id_employee, work_date, start_time, end_time) VALUES
(0, 0, '2021-04-05', '08:00', '13:00'),
(1, 2, '2021-04-05', '08:00', '18:00'),
(2, 4, '2021-04-05', '12:00', '18:00'),
(3, 5, '2021-04-05', '08:00', '18:00'),
(4, 6, '2021-04-05', '12:00', '18:00'),
(5, 8, '2021-04-05', '08:00', '13:00'),
(6, 9, '2021-04-05', '08:00', '18:00'),

(7, 1, '2021-04-06', '08:00', '13:00'),
(8, 3, '2021-04-06', '08:00', '18:00'),
(9, 4, '2021-04-06', '12:00', '18:00'),
(10, 5, '2021-04-06', '08:00', '18:00'),
(11, 7, '2021-04-06', '12:00', '18:00'),
(12, 8, '2021-04-06', '08:00', '13:00'),
(13, 10, '2021-04-06', '08:00', '18:00'),

(14, 0, '2021-04-07', '08:00', '13:00'),
(15, 2, '2021-04-07', '08:00', '18:00'),
(16, 4, '2021-04-07', '12:00', '18:00'),
(17, 5, '2021-04-07', '08:00', '18:00'),
(18, 6, '2021-04-07', '12:00', '18:00'),
(19, 8, '2021-04-07', '08:00', '13:00'),

(20, 1, '2021-04-08', '08:00', '13:00'),
(21, 3, '2021-04-08', '08:00', '18:00'),
(22, 4, '2021-04-08', '12:00', '18:00'),
(23, 5, '2021-04-08', '08:00', '18:00'),
(24, 7, '2021-04-08', '12:00', '18:00'),
(25, 8, '2021-04-08', '08:00', '13:00'),
(26, 10, '2021-04-08', '08:00', '18:00'),

(27, 0, '2021-04-09', '12:00', '18:00'),
(28, 2, '2021-04-09', '08:00', '18:00'),
(29, 4, '2021-04-09', '12:00', '18:00'),
(30, 5, '2021-04-09', '08:00', '18:00'),
(31, 6, '2021-04-09', '12:00', '18:00'),
(32, 8, '2021-04-09', '08:00', '13:00'),
(33, 9, '2021-04-09', '08:00', '18:00'),

(34, 0, '2021-04-10', '08:00', '13:00'),
(35, 2, '2021-04-10', '13:00', '18:00'),
(36, 4, '2021-04-10', '13:00', '18:00'),
(37, 5, '2021-04-10', '08:00', '13:00'),

(38, 1, '2021-04-11', '08:00', '13:00'),
(39, 3, '2021-04-11', '08:00', '13:00'),
(40, 6, '2021-04-11', '13:00', '18:00'),
(41, 8, '2021-04-11', '13:00', '18:00');

INSERT INTO work_track (id, id_employee, id_service, work_date, start_work_time, end_work_time, work_state, client_name, client_last_name, client_second_name, client_phone_number) VALUES
(1, 8, 3, '2021-04-06', '11:00', '13:00', 'Завершено', 'Ашрятова', 'Римма', 'Равильевна', '89631450430'),
(2, 0, 5, '2021-04-05', '08:00', '08:30', 'Завершено', 'Борисов', 'Александр', 'Юрьевич', '89174465483'),
(3, 3, 1, '2021-04-06', '09:00', '10:00', 'Завершено', 'Гарин', 'Максим', 'Александрович', '89134556722'),
(4, 4, 5, '2021-04-05', '12:00', '12:30', 'Завершено', 'Головатюк', 'Анастасия', 'Михайловна', '89510573444'),
(5, 6, 4, '2021-04-07', '14:00', '15:00', 'Завершено', 'Горбунов', 'Андрей', 'Александрович', '89172263389'),
(6, 9, 4, '2021-04-05', '10:00', '11:00', 'Завершено', 'Гуськов', 'Артем', 'Сергеевич', '89276943515'),
(7, 5, 7, '2021-04-06', '14:00', '15:00', 'Завершено', 'Дворянинова', 'Дарья', 'Алексеевна', '89524553672'),
(8, 2, 3, '2021-04-05', '11:00', '13:00', 'Завершено', 'Еделева', 'Юлия', 'Павловна', '89157726354'),
(9, 4, 1, '2021-04-05', '13:00', '14:00', 'Завершено', 'Зевайкин', 'Андрей', 'Евгеньевич', '89150073608'),
(10, 3, 1, '2021-04-06', '12:00', '13:00', 'Завершено', 'Исоков', 'Асадбек', 'Анваржонович', '89630473607'),
(11, 7, 8, '2021-04-06', '12:00', '13:00', 'Завершено', 'Казакова', 'Ирина', 'Сергеевна', '89625134492'),
(12, 10, 6, '2021-04-06', '17:00', '18:00', 'Завершено', 'Квашнин', 'Кирилл', 'Алексеевич', '89271354672'),
(13, 0, 5, '2021-04-07', '09:30', '10:00', 'Завершено', 'Кирдюшкин', 'Данила', 'Владимирович', '89992361125'),
(14, 1, 1, '2021-04-06', '08:00', '09:00', 'Завершено', 'Пупкин', 'Василий', 'Иванович', '89941627187');